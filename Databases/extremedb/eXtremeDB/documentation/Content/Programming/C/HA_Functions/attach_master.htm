<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="extremedb.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Programming with eXtremeDB|Native APIs|[%=System.LinkedTitle%]|Static API|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>mco_HA_attach_master</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/KB_Style.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/FunctionReference.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="TopicContent">
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="7" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">ToC path: </span>
                </div>
            </div>
            <h1>mco_HA_attach_master</h1>
            <p>This function is called by the replica application  to request a connection to the master.</p>
            <h3>For an overview see page <a href="../../../Users_Guides/HA/HA_Applications.htm">HA Applications</a></h3>
            <h3>Prototype</h3>
            <div class="code-block"><pre>&#160;
    MCO_RET mco_HA_attach_master(	mco_db_h* db, 
                      const char* connection_string, 
                      const mco_HA_replica_params_t* params, 
                      MCO_E_HA_REPLICA_STOP_REASON* reason, 
                      timer_unit timeout );
                      &#160;
&#160;</pre>
            </div>
            <h3>Arguments</h3>
            <table class="TableStyle-FunctionReference" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/FunctionReference.css');" cellspacing="0">
                <col class="TableStyle-FunctionReference-Column-Column2" />
                <col class="TableStyle-FunctionReference-Column-Column2" />
                <tbody>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">db</td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">Pointer to a database connection handle. If *db is NULL, <code>mco_HA_attach_master()</code> creates a new database using parameters from <code>db_params</code>.  If  *db is a valid connection to an existing database, the database switches to replica mode and is synchronized with the master’s.</td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">
                            <p>connection_string</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">
                            <p>Transport layer dependent connection string.. For TCP/UDP transport it should be “&lt;masterhost&gt;:&lt;port&gt;”, where masterhost is the hostname or IP-address of the master node, and &lt;port&gt; is the number of the listening port (defined on the master side by the “masterport” parameter of <code>mco_nw_attach_replica()</code>.  For example, “192.168.0.1:10000”.</p>
                            <p>For PIPES transport it should be a pipe name (e.g. “/tmp/test00”).</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">
                            <p>params</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">
                            <p>Connection parameters (see <a href="replica_params_init.htm">mco_HA_replica_params_init</a>).</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">
                            <p>reason</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">
                            <p>The reason why <code>mco_HA_attach_master()</code> is being interrupted., as defined below.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyB-Column2-Body1">
                            <p>timeout</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyA-Column2-Body1">
                            <p>Connection timeout period.  If the master does not connect within this period, the function returns <code>MCO_E_NW_TIMEOUT</code>.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <h3>Description</h3>
            <p>This function is called by a replica application after calling the <code><a href="../Core_Functions/Static/Database_Control/open_dev.htm">mco_db_open_dev()</a></code> or <code><a href="../Core_Functions/Static/Database_Control/load.htm">mco_db_load()</a></code> to open a database.  Note that <code>mco_HA_attach_master()</code> is a blocking call that internally performs handshaking with the master, loads the master’s current state (database), and waits to accept transactions from the master. It exits when one of the following occurs:</p>
            <p>- An unrecoverable error is detected</p>
            <p>- 	Requested by the master</p>
            <p>- 	A local asynchronous request from the standby’s application is issued via <code><a href="replica_stop.htm">mco_HA_replica_stop()</a></code></p>
            <p>- 	A cancel request is issued via <code><a href="cancel.htm">mco_HA_cancel()</a></code></p>
            <p>- 	The flag passed to the function is <code>MCO_HAMODE_FORCE_MASTER</code>; this causes the attaching process (a replica at this moment) to synchronize the database with the current master, then send a <code>KILL_MASTER</code> message to the current master, detach itself from the master and become the new master. This flag is normally associated with <a href="../../../Users_Guides/Core/Features/Binary_Schema_Evolution.htm">Binary Schema Evolution</a>.</p>
            <p>When the function returns, the application may elect to destroy the database, to start using it as a master database, or to start using it as a standby database again.</p>
            <h3>Return Codes</h3>
            <table class="TableStyle-FunctionReference" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/FunctionReference.css');" cellspacing="0">
                <col class="TableStyle-FunctionReference-Column-Column2" />
                <col class="TableStyle-FunctionReference-Column-Column2" />
                <tbody>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_S_OK</td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">The master was connected  successfully.</td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">
                            <p>MCO_E_HA_PROTOCOLERR</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">
                            <p>Incompatible protocol.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">
                            <p>MCO_E_HA_IOERROR</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">
                            <p>The replica was unable to send or receive a message to/from the master.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">
                            <p>MCO_E_NW_TIMEOUT</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">
                            <p>Master not connected within the specified timeout period.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-FunctionReference-Body-Body1">
                        <td class="TableStyle-FunctionReference-BodyB-Column2-Body1">
                            <p>other MCO_E_NW_* codes</p>
                        </td>
                        <td class="TableStyle-FunctionReference-BodyA-Column2-Body1">
                            <p>Errors in the network transport layer.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="copyright" style="font-size: 8pt;"><a href="../../../Copyright_Notice.htm" title="Copyright Notice" alt="Copyright Notice">© 2001-2019 McObject LLC. All rights reserved</a>.</p>
            <p class="copyright" style="font-size: 8pt;">&#160;</p>
            <p class="copyrightFeedback" style="font-size: 8pt;"><a href="mailto:Support@McObject.com?subject=Online Documentation feedback">Send feedback</a> <span style="color: #000000;">on this topic to McObject. </span></p>
        </div>
    </body>
    <script id="MCO-LINKS">/* <![CDATA[ */
		(function(){
		var isFramed = false;
		try {
		isFramed = window != window.top || document != top.document || self.location != top.location;
		} catch (e) {
		isFramed = true;
		}
		if (!isFramed) {
		var link1 = document.createElement('a');
		link1.setAttribute('href','#');
		link1.setAttribute('id','back-id');
		link1.setAttribute('title','Go back');
		link1.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M0 0h24v24H0z" fill="none" /><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" /></svg>';
		var link2 = document.createElement('a');
		link2.setAttribute('href','/');
		link2.setAttribute('title','Go to mcobject.com');
		link2.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var link3 = document.createElement('a');
		link3.setAttribute('href','/docs/extremedb.htm');
		link3.setAttribute('title','Go to table of content');
		link3.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var el = document.createElement('div');
		el.style.cssText = 'position:fixed;display:flex;flex-direction:column;right:16px;top:8px;background:#f7f7f7;box-shadow:4px 4px 4px #777777;padding:4px 8px;';
		el.appendChild(link1);
		el.appendChild(link2);
		el.appendChild(link3);
		document.body.append(el);
		document.querySelector('#back-id').addEventListener('click',function(e){e.preventDefault(); window.history.back();});
		}
		})();
	/* ]]> */</script>
</html>