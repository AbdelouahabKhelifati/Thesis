<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="extremedb.xml" data-mc-path-to-help-system="../../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Programming with eXtremeDB|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>SQL Sequence Cumulative Aggregate Max, Min, Sum, Prd, Avg, Var and Dev Functions</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../Resources/Stylesheets/KB_Style.css" rel="stylesheet" />
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="TopicContent">
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="7" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">ToC path: </span>
                </div>
            </div>
            <h1>SQL Sequence Cumulative Aggregate Max, Min, Sum, Prd, Avg, Var and Dev Functions</h1>
            <blockquote>
                <p>The  <code>seq_cum_agg_sum()</code>,<code>seq_cum_agg_min()</code>, <code>seq_cum_agg_prd()</code>, <code>seq_cum_agg_avg()</code>, <code>seq_cum_agg_var()</code>, <code>seq_cum_agg_dev()</code> functions return a sequence with the cumulative maximum (maximum. minimum, etc ... of all preceding elements) in each element.</p>
                <p>Following is an example script demonstrating these functions:</p>
                <div class="code-block"><pre>&#160;
    SELECT symbol, seq_search(day, 20130101, 20130331) as Q1_13,
            volume@Q1_13 as "Volume_Q1_13",
            seq_cum_agg_max(volume@Q1_13) as "max_Q1_13",
            seq_cum_agg_min(volume@Q1_13) as "min_Q1_13",
            seq_cum_agg_sum(volume@Q1_13) as "sum_Q1_13",
            seq_cum_agg_avg(volume@Q1_13) as "avg_Q1_13",
            seq_cum_agg_var(volume@Q1_13) as "var_Q1_13",
            seq_cum_agg_dev(volume@Q1_13) as "dev_Q1_13"
    FROM Quote WHERE symbol='SYM0';
    &#160;
    symbol
    Q1_13{}
    Volume_Q1_13{}
    max_Q1_13{}
    min_Q1_13{}
    sum_Q1_13{}
    prd_Q1_13{}
    avg_Q1_13{}
    var_Q1_13{}
    dev_Q1_13{}
    ------------------------------------------------------------------------------
    SYM0
    {20130101, 20130104, 20130106, 20130110, 20130123, 20130125, 20130129,
      20130213, 20130214, 20130216, 20130311, 20130326}
    {335, 808, 45, 402, 732, 48, 805,
      450, 385, 420, 367, 69}
    {335, 808, 808, 808, 808, 808, 808,
      808, 808, 808, 808, 808}
    {335, 335, 45, 45, 45, 45, 45,
      45, 45, 45, 45, 45}
    {335, 1143, 1188, 1590, 2322, 2370, 3175,
      3625, 4010, 4430, 4797, 4866}
    {335, 270680, 12180600, 4896601200, 3584312078400, 172046979763200, 138497818709376000,
      6983786198090545152, -4466948496734652416, 5449526889820250112, 7728008603400216576,
    -1722984502962053120}
    {335.000000, 571.500000, 396.000000, 397.500000, 464.400000, 395.000000, 453.571429,
      453.125000, 445.555556, 443.000000, 436.090909, 405.500000}
    {0, 55932, 98888, 74173, 77241, 88449, 96397,
      84349, 75435, 67950, 62250, 67356}
    {0, 236, 314, 272, 277, 297, 310,
      290, 274, 260, 249, 259}
        &#160;</pre>
                </div>
                <p>Each element of the result sequences from the Cum_Agg functions is the cumulative max, min, sum, product average, variance or standard deviation of all of the previous elements in the sequence. These results can be verified using the following table (built with Microsoft Excel version 2010):</p>
                <p>
                    <img src="../../../../Resources/Images/Cum_agg.jpg" />
                </p>
                <p>Note that <code>seq_cum_agg_prd()</code> very quickly produces huge numbers, and the result sequence may contain erroneous output due to overflow (see the highlighted elements in the sample output above.)</p>
                <h2>Sample script</h2>
                <p>A sample script to demonstrate this <code>select</code> statement using <span style="color: #000000; font-style: italic; font-weight: normal;">xSQL</span> can be run from the <code>samples/xsql/scripts/financial</code> directory with the following command:</p>
                <div class="code-block"><pre>    &#160;
    g 10
    &#160;</pre>
                </div>
            </blockquote>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="copyright" style="font-size: 8pt;"><a href="../../../../Copyright_Notice.htm" title="Copyright Notice" alt="Copyright Notice">Â© 2001-2019 McObject LLC. All rights reserved</a>.</p>
            <p class="copyright" style="font-size: 8pt;">&#160;</p>
            <p class="copyrightFeedback" style="font-size: 8pt;"><a href="mailto:Support@McObject.com?subject=Online Documentation feedback">Send feedback</a> <span style="color: #000000;">on this topic to McObject. </span></p>
        </div>
    </body>
    <script id="MCO-LINKS">/* <![CDATA[ */
		(function(){
		var isFramed = false;
		try {
		isFramed = window != window.top || document != top.document || self.location != top.location;
		} catch (e) {
		isFramed = true;
		}
		if (!isFramed) {
		var link1 = document.createElement('a');
		link1.setAttribute('href','#');
		link1.setAttribute('id','back-id');
		link1.setAttribute('title','Go back');
		link1.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M0 0h24v24H0z" fill="none" /><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" /></svg>';
		var link2 = document.createElement('a');
		link2.setAttribute('href','/');
		link2.setAttribute('title','Go to mcobject.com');
		link2.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var link3 = document.createElement('a');
		link3.setAttribute('href','/docs/extremedb.htm');
		link3.setAttribute('title','Go to table of content');
		link3.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var el = document.createElement('div');
		el.style.cssText = 'position:fixed;display:flex;flex-direction:column;right:16px;top:8px;background:#f7f7f7;box-shadow:4px 4px 4px #777777;padding:4px 8px;';
		el.appendChild(link1);
		el.appendChild(link2);
		el.appendChild(link3);
		document.body.append(el);
		document.querySelector('#back-id').addEventListener('click',function(e){e.preventDefault(); window.history.back();});
		}
		})();
	/* ]]> */</script>
</html>