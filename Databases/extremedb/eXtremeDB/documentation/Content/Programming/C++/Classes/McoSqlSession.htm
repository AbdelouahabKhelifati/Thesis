<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="extremedb.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Programming with eXtremeDB|Native APIs|C++ API|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>The C++ McoSqlSession Class</title>
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Resources/Stylesheets/KB_Style.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/IndentedFunctionReference.css" rel="stylesheet" />
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="TopicContent">
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="7" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">ToC path: </span>
                </div>
            </div>
            <h1>The C++ <i>McoSqlSession</i> Class</h1>
            <blockquote>
                <blockquote>
                    <p>The <i>McoSqlSession</i> class is used to share a single database connection between multiple threads.</p>
                    <h3>For an overview see page <a href="../Cpp_Classes.htm">C++ Classes</a></h3>
                    <p>This class must be used to share a single database connection between multiple threads. Multi-threaded applications can use their own SQL engine for each connected thread (i.e. create their own instance of <i><a href="McoSqlEngine.htm">McoSqlEngine</a></i>). However, this is not convenient and not very efficient. In many cases the application does not start threads by itself, rather the thread pool is maintained by some external component and the user code is executed in the context of one of those threads. (A typical example is Apache <i>servlets</i>.)</p>
                    <p><i>McoSqlSession</i> allows multiple threads to share a single <i><a href="McoMultithreadedSqlEngine.htm">McoMultithreadedSqlEngine</a></i> instance. The constructor of this class uses function <code><a href="../../C/Core_Functions/Static/Database_Control/connect.htm">mco_db_connect()</a></code> to establish a connection for a particular thread. The destructor of this class releases the connection by calling <code><a href="../../C/Core_Functions/Static/Database_Control/disconnect.htm">mco_db_disconnect()</a></code>. </p>
                    <p><i>McoSqlSession</i> inherits all of the public methods of <a href="McoSqlEngine.htm" style="font-style: italic;">McoSqlEngine</a> and its base class <i><a href="SqlEngine.htm">SqlEngine</a></i>. The only additional specialized methods are its constructor and destructor as described in the table below. </p>
                    <table class="TableStyle-IndentedFunctionReference" style="margin-left: 0;margin-right: auto;mc-table-style: url('../../../Resources/TableStyles/IndentedFunctionReference.css');" cellspacing="0">
                        <col class="TableStyle-IndentedFunctionReference-Column-Column1" style="width: 388px;" />
                        <col class="TableStyle-IndentedFunctionReference-Column-Column2" style="width: 464px;" />
                        <tbody>
                            <tr class="TableStyle-IndentedFunctionReference-Body-Body1">
                                <td class="TableStyle-IndentedFunctionReference-BodyE-Column1-Body1"><b>McoSqlSession(McoSqlEngine* engine)</b>
                                </td>
                                <td class="TableStyle-IndentedFunctionReference-BodyD-Column2-Body1">Constructor: establishes a connection for the thread by calling <code href="../../C/Core_Functions/Static/Database_Control/connect.htm"><a href="../../C/Core_Functions/Static/Database_Control/connect.htm">mco_db_connect()</a></code>; the argument engine is a share instance of <i><a href="McoMultithreadedSqlEngine.htm">McoMultithreadedSqlEngine</a></i><![CDATA[     ]]></td>
                            </tr>
                            <tr class="TableStyle-IndentedFunctionReference-Body-Body1">
                                <td class="TableStyle-IndentedFunctionReference-BodyB-Column1-Body1">~McoSqlSession()</td>
                                <td class="TableStyle-IndentedFunctionReference-BodyA-Column2-Body1">Destructor: releases the connection by calling <code><a href="../../C/Core_Functions/Static/Database_Control/disconnect.htm">mco_db_disconnect()</a></code></td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>Example</h3>
                    <p>Typically, an <i>McoSqlSession</i> object is instantiated to manage transaction blocking in multi-threaded applications by calling it's <i><a href="Database.htm">Database</a></i> member's <code><a href="Database.htm">beginTransaction()</a></code> method. For example:</p>
                    <div class="code-block"><pre>&#160;
    McoMultithreadedSqlEngine engine;
    ...
    &#160;
    McoSqlSession session(&amp;engine);
    Transaction* trans = session-&gt;database()-&gt;beginTransaction(Transaction::ReadWrite);
    session-&gt;executeStatement(trans, "update Member set balance=%i where id=%i",
                    fromBalance, idFrom);
    session-&gt;executeStatement(trans, "update Member set balance=%i where id=%i",
                    toBalance, idTo);
    trans-&gt;commit();
    trans-&gt;release();
    &#160;</pre>
                    </div>
                </blockquote>
            </blockquote>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="copyright" style="font-size: 8pt;"><a href="../../../Copyright_Notice.htm" title="Copyright Notice" alt="Copyright Notice">Â© 2001-2019 McObject LLC. All rights reserved</a>.</p>
            <p class="copyright" style="font-size: 8pt;">&#160;</p>
            <p class="copyrightFeedback" style="font-size: 8pt;"><a href="mailto:Support@McObject.com?subject=Online Documentation feedback">Send feedback</a> <span style="color: #000000;">on this topic to McObject. </span></p>
        </div>
    </body>
    <script id="MCO-LINKS">/* <![CDATA[ */
		(function(){
		var isFramed = false;
		try {
		isFramed = window != window.top || document != top.document || self.location != top.location;
		} catch (e) {
		isFramed = true;
		}
		if (!isFramed) {
		var link1 = document.createElement('a');
		link1.setAttribute('href','#');
		link1.setAttribute('id','back-id');
		link1.setAttribute('title','Go back');
		link1.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M0 0h24v24H0z" fill="none" /><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" /></svg>';
		var link2 = document.createElement('a');
		link2.setAttribute('href','/');
		link2.setAttribute('title','Go to mcobject.com');
		link2.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var link3 = document.createElement('a');
		link3.setAttribute('href','/docs/extremedb.htm');
		link3.setAttribute('title','Go to table of content');
		link3.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var el = document.createElement('div');
		el.style.cssText = 'position:fixed;display:flex;flex-direction:column;right:16px;top:8px;background:#f7f7f7;box-shadow:4px 4px 4px #777777;padding:4px 8px;';
		el.appendChild(link1);
		el.appendChild(link2);
		el.appendChild(link3);
		document.body.append(el);
		document.querySelector('#back-id').addEventListener('click',function(e){e.preventDefault(); window.history.back();});
		}
		})();
	/* ]]> */</script>
</html>