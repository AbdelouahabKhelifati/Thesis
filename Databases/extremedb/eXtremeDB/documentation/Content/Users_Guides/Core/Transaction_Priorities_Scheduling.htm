<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="extremedb.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Transaction Priorities and Scheduling</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/KB_Style.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/FunctionReference.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="TopicContent">
            <div class="nocontent">
                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="7" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">ToC path: </span>
                </div>
            </div>
            <h1>Transaction Priorities and Scheduling</h1>
            <blockquote>
                <p>With <code><a name="kanchor122"></a>MURSIW</code>, <i>e</i>X<i>treme</i>DB<a name="kanchor123"></a> supports transaction priorities; i.e. it is possible to assign a priority value to each transaction at runtime.  At the time a transaction is registered with the runtime, the transaction scheduler checks the priority value and shifts the transaction forward or backwards in the transaction queue accordingly.  With the <code><a href="MURSIW_Transaction_Manager.htm">MURSIW</a></code><a name="kanchor124"></a> transaction manager, applications normally execute as foreground transactions, however by using the transaction priority mechanism, an application can also “boost” the execution of a transaction to high-priority at runtime if necessary. The <i>e</i>X<i>treme</i>DB transaction priorities are defined as follows:</p>
                <table class="TableStyle-FunctionReference" style="mc-table-style: url('../../Resources/TableStyles/FunctionReference.css');margin-left: 0;margin-right: auto;" cellspacing="0">
                    <col class="TableStyle-FunctionReference-Column-Column2" />
                    <col class="TableStyle-FunctionReference-Column-Column2" />
                    <tbody>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_TRANS_IDLE</td>
                            <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">Least important transactions</td>
                        </tr>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_TRANS_BACKGROUND</td>
                            <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">Less important then foreground but more important then idle</td>
                        </tr>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_TRANS_FOREGROUND</td>
                            <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">Normal priority transactions</td>
                        </tr>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_TRANS_HIGH</td>
                            <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">More important then foreground but less important then ISR</td>
                        </tr>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyB-Column2-Body1">MCO_TRANS_ISR</td>
                            <td class="TableStyle-FunctionReference-BodyA-Column2-Body1">Very Important Transactions</td>
                        </tr>
                    </tbody>
                </table>
                <p>&#160;</p>
                <h2><a name="kanchor125"></a>MVCC Transaction Priocessing</h2>
                <p>Transaction priorities with <code><a href="MVCC_Transaction_Manager.htm">MVCC</a></code> have a slightly different meaning.  Transactions with priority above "normal" (<code>MCO_TRANS_FOREGROUND</code>) lock the entire index – reducing parallel access to tree and hash structures to read-only access.  By doing so, the transaction avoids locking index pages during cursor movements, which can improve performance when there’s a need to iterate over many objects.  The lock is released when a cursor reaches the end of the result set, or by calling the cursor <code>close</code> method. The implication of reducing  parallel access to tree and hash structures (indexes) to read-only is that a parallel transaction updating objects of the same class when the class in question does not have <code>oid</code> or <code><a name="kanchor126"></a>autoid</code>, will block when it calls the transaction commit function, until the higher priority task releases the lock.  For classes with <code>oid</code> or <code>autoid</code>, the <code>oid</code> or <code>autoid</code> index is updated as soon as the class <code>new</code> method is invoked, so the parallel task will be blocked on this function until the higher priority task releases the lock. The potential for parallel tasks to be blocked needs to be weighed against the performance gain of avoiding setting and releasing a short term lock during each cursor movement (e.g. the cursor <code>next</code> method).</p>
                <p>
                    <img src="../../Resources/Images/note.png" /> 	When adjusting Transaction Priority be aware of the “Priority Inversion Problem” described at <a href="http://en.wikipedia.org/wiki/Priority_inversion">http://en.wikipedia.org/wiki/Priority_inversion</a> .</p>
                <h2>MURSIW Transaction Scheduling Policies</h2>
                <p>The <code>MURSIW</code> transaction manager algorithm places all incoming transactions into the queue according to the Transaction Priority. When a new incoming transaction attempts to gain access to the database runtime, the <code>MURSIW</code> manager makes sure that</p>
                <ul>
                    <li value="1">there is no conflict with an already active transaction</li>
                    <li value="2">	there is no higher or equal priority transaction waiting in the queue</li>
                </ul>
                <p>If the incoming transaction is a read-write transaction (<code>MCO_READ_WRITE</code>), the database runtime does not check on the higher priority transactions. The rationale behind this is that even if there were any higher priority transactions at the moment, it would indicate that they were waiting on some other transaction that would prevent the incoming one to get exclusive ("read-write") access to the database. Once the transaction is finalized (committed or rolled back), the <code>MURSIW</code> algorithm picks the next transaction from the queue. In order to avoid a scenario in which active "read-only" transactions block access to a higher priority "read-write" transaction, and to ensure the <span class="Param">FIFO</span> scheduling policy, the <code>MURSIW</code> transaction manager does not allow an incoming read-only transaction with a priority lower than a queued read-write transaction priority to get scheduled right-away.</p>
                <p>The default scheduling policy of transaction priorities can be controlled by the application using the following flags which determine the policy for transactions with the same priority:</p>
                <table class="TableStyle-FunctionReference" style="mc-table-style: url('../../Resources/TableStyles/FunctionReference.css');margin-left: 0;margin-right: auto;" cellspacing="0">
                    <col class="TableStyle-FunctionReference-Column-Column2" />
                    <col class="TableStyle-FunctionReference-Column-Column2" />
                    <tbody>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_SCHED_FIFO</td>
                            <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">The default First-In-First-Out scheduling</td>
                        </tr>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyE-Column2-Body1">MCO_SCHED_READER_FAVOR</td>
                            <td class="TableStyle-FunctionReference-BodyD-Column2-Body1">Prioritize read-only transactions by placing them ahead of the same priority read-write transactions into the queue</td>
                        </tr>
                        <tr class="TableStyle-FunctionReference-Body-Body1">
                            <td class="TableStyle-FunctionReference-BodyB-Column2-Body1">MCO_SCHED_WRITER_FAVOR</td>
                            <td class="TableStyle-FunctionReference-BodyA-Column2-Body1">Prioritize read-write transactions </td>
                        </tr>
                    </tbody>
                </table>
            </blockquote>
            <p style="font-size: 6pt;margin-top: 0;margin-bottom: 0;">&#160;</p>
            <hr width="100%" size="0" align="center" />
            <p class="copyright" style="font-size: 8pt;"><a href="../../Copyright_Notice.htm" title="Copyright Notice" alt="Copyright Notice">© 2001-2019 McObject LLC. All rights reserved</a>.</p>
            <p class="copyright" style="font-size: 8pt;">&#160;</p>
            <p class="copyrightFeedback" style="font-size: 8pt;"><a href="mailto:Support@McObject.com?subject=Online Documentation feedback">Send feedback</a> <span style="color: #000000;">on this topic to McObject. </span></p>
        </div>
    </body>
    <script id="MCO-LINKS">/* <![CDATA[ */
		(function(){
		var isFramed = false;
		try {
		isFramed = window != window.top || document != top.document || self.location != top.location;
		} catch (e) {
		isFramed = true;
		}
		if (!isFramed) {
		var link1 = document.createElement('a');
		link1.setAttribute('href','#');
		link1.setAttribute('id','back-id');
		link1.setAttribute('title','Go back');
		link1.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M0 0h24v24H0z" fill="none" /><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" /></svg>';
		var link2 = document.createElement('a');
		link2.setAttribute('href','/');
		link2.setAttribute('title','Go to mcobject.com');
		link2.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var link3 = document.createElement('a');
		link3.setAttribute('href','/docs/extremedb.htm');
		link3.setAttribute('title','Go to table of content');
		link3.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="#555555"><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z" /><path d="M0 0h24v24H0z" fill="none" /></svg>';
		var el = document.createElement('div');
		el.style.cssText = 'position:fixed;display:flex;flex-direction:column;right:16px;top:8px;background:#f7f7f7;box-shadow:4px 4px 4px #777777;padding:4px 8px;';
		el.appendChild(link1);
		el.appendChild(link2);
		el.appendChild(link3);
		document.body.append(el);
		document.querySelector('#back-id').addEventListener('click',function(e){e.preventDefault(); window.history.back();});
		}
		})();
	/* ]]> */</script>
</html>